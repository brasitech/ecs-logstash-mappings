# Corelight ECS Logstash Pipeline
# Git Repository: https://github.com/corelight/ecs-logstash-mappings
# Authors: Corelight Inc, Brasi Tech LLC
# License: BSD 3-Clause
# Support: https://github.com/corelight/ecs-logstash-mappings/issues/new
# Releases: https://github.com/corelight/ecs-logstash-mappings/releases

# network.transport is common across many of the logs with only a few variations. Thus handle them all in one config
filter {
  if [@metadata][z_no_reuse][event_type] == "corelight" {
    
    if [network][protocol] {
    
        mutate {
          lowercase => [ "[network][protocol]" ]
          add_field => {
            "[@metadata][etl][pipeline]" => "filter-mutate-42da94b8eebb-20220719.01"
          }
          tag_on_failure => "_mutate_error-42da94b8eebb-20220719.01"
          id => "filter-mutate-42da94b8eebb"
        }
      
    }
  }
}
